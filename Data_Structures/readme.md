Some of the code was hardly assisted by https://github.com/fatpound
